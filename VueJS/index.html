<!DOCTYPE html>
<head>
    <title>carambibi</title>
    <meta charset="utf-8">
    <script src="https://unpkg.com/vue/dist/vue.js"></script>
    <script src="https://unpkg.com/vue-router/dist/vue-router.js"></script>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
    <link rel="stylesheet" type="text/css" href="style.css">

</head>

<body>

<div class="title" id="title">
    {{ title }}
</div>

<div class="container">

    <div id="market">

        <div class="filter row btn-toolbar">
            <div class="input-group mb-3">
                <input type="text" class="form-control" placeholder="Rechercher" aria-label="Rechercher" aria-describedby="basic-addon2">
                <div class="input-group-append">
                    <button class="btn btn-outline-secondary search-btn" type="button"> <i class="fas fa-search"></i></button>
                </div>
            </div>
            <div class="dropdown">
                <button class="btn btn-outline-secondary dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    Catégorie
                </button>
                <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                    <a class="dropdown-item" href="#">Au fruits</a>
                    <a class="dropdown-item" href="#">Au caramel</a>
                    <a class="dropdown-item" href="#">Qui pique</a>
                </div>
            </div>
        </div>

        <ul class="items">
            <li v-for="carambar in carambars" class="hvr-grow">

                <item>
                    <div slot="img">
                        <img class="card-img-top" v-bind:src="carambar.image" />
                    </div>
                    <div slot="title">
                        {{ carambar.name}}
                    </div>
                    <div slot="desc">
                        {{carambar.desc}}
                    </div>
                    <div slot="action">
                        <a href="#" class="btn btn-primary" v-on:click="show(carambar)">Voir les offres ({{carambar.offers.length}})</a>
                    </div>
                </item>

            </li>
        </ul>

        <modal v-if="showModal" @close="showModal = false">
            <h3 slot="header">{{ selectedCarambar.name}}</h3>

            <div slot="desc">
                <div>{{ selectedCarambar.desc}}</div>
                <div class="modal-rating">
                        <span v-for="n in 5">
                <img v-if="n <= selectedCarambar.rating"
                     src="https://cdn4.iconfinder.com/data/icons/small-n-flat/24/star-512.png"/>
                <img v-if="n > selectedCarambar.rating"
                     src="https://cdn4.iconfinder.com/data/icons/sports-technology-and-people/1000/2-01-512.png"/>
              </span>
                </div>
                <div>{{ selectedCarambar.offers.length}} vendeurs à proximité</div>
            </div>

            <div slot="img">
                <img class="modal-img" v-bind:src="selectedCarambar.image" />
            </div>

            <div slot="offers">
                <ul class="list-group mt-5">
                    <li v-for="offer in selectedCarambar.offers" class="list-group-item">

                        <div class="row">

                            <div class="col-3">
                                <u>{{offer.user}}</u>
                            </div>
                            <div class="col-5">
                                <div class="distance">
                                    <i class="fas fa-map-marker-alt"></i> À {{randomInt()}} km de vous
                                </div>
                                <div class="note">
                                    <i class="fas fa-star"></i> Note : {{offer.rating}}
                                </div>
                            </div>
                            <div class="col-2">
                                {{offer.price}}
                                <br> € / g
                            </div>
                            <div class="col-2 offer-action">
                                <button type="button" class="btn btn-default btn-lg"
                                v-on:click="confirm(offer)">
                                    <i class="fas fa-shopping-cart"></i>
                                </button>
                            </div>
                        </div>

                    </li>
                </ul>
            </div>
        </modal>

        <modal v-if="showConfirmModal" @close="showConfirmModal = false">
            <h3 slot="header">Confirmation de rendez-vous avec <i>{{ selectedOffer.user}}</i></h3>
            <div slot="img">
                <img class="fake-map"
                     src="https://iphonesoft.fr/images/_122012/google_maps_donnees_localisation.jpg"/>
            </div>

            <div slot="desc">
                <p>Téléchargez l'application pour vous laisser guider jusqu'au bas des blocs</p>
                <img height="100px" src="https://h24-original.s3.amazonaws.com/120041/22642034-Wrt29.jpg"/>
                <img height="100px" src="http://azonmobile.com/cms/system_direct_files/qrcodes/b76170dabe4189bdd2acf273224955fb432906f8f3bad3907b38451f2dd7949e.png"/>
            </div>
            <div slot="offers"></div>
        </modal>

    </div>
</div>

<script type="text/template" id="item-template">
    <div class="card">
        <div class="card-title">
            <slot name="title">
                default name
            </slot>
        </div>
        <div class="item-img">
            <slot name="img">
                default img
            </slot>
        </div>
        <div class="card-body">
            <div class="card-text">
                <slot name="desc">
                    default desc
                </slot>
            </div>
        </div>

        <div class="card-bottom">
            <slot name="action">
                <a>default action</a>
            </slot>
        </div>
    </div>

</script>


<script type="text/x-template" id="modal-template">
    <transition name="modal">
        <div class="modal-mask">
            <div class="modal-wrapper">
                <div class="modal-container row">

                    <div class="modal-header col-11">
                        <slot name="header">
                            default header
                        </slot>
                    </div>

                    <div class="modal-close col-1">
                        <button @click="$emit('close')">X</button>
                    </div>

                    <div class="modal-body">
                        <div class="row">
                            <div class="col-8 modal-desc">
                                <slot name="desc">
                                    default desc
                                </slot>
                            </div>
                            <div class="col-4">
                                <slot name="img">
                                    default img
                                </slot>
                            </div>
                        </div>

                        <div class="modal-offers">
                            <slot name="offers">
                                default offers
                            </slot>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <slot name="footer">
                        </slot>
                    </div>
                </div>
            </div>
        </div>
    </transition>
</script>

<script type="text/javascript" src="data.js"></script>
<script type="text/javascript" src="script.js"></script>
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.3.1/css/all.css" integrity="sha384-mzrmE5qonljUremFsqc01SB46JvROS7bZs3IO2EmfFsd15uHvIt+Y8vEf7N7fWAU" crossorigin="anonymous">
<link href='https://fonts.googleapis.com/css?family=Rock+Salt' rel='stylesheet' type='text/css'>
<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>
</body>

</html>